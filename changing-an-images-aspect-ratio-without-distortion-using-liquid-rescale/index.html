<!DOCTYPE html>
<html>

<head>
    <title>Changing an image&#039;s aspect ratio without distortion, using Liquid Rescale &mdash; Ciaran McNulty</title>
    <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width" />
    <link rel="stylesheet" href="/main.css?v=1" />
    <!--[if gt IE 7]><!-->
    <link rel="stylesheet" href="/layout.css?v=1" />
    <!--<![endif]-->
    <link rel="openid.server" href="http://www.livejournal.com/openid/server.bml" />
    <link rel="openid.delegate" href="http://ciaranmcnulty.livejournal.com" />
</head>
<body>

    <header>
        <h1><a href="/">Ciaran McNulty</a></h1>
    </header>

    <section id="blog">
    <h2>Changing an image&#039;s aspect ratio without distortion, using Liquid Rescale</h2>

    <h3><time>16th April 2009</time></h3>

    <p>Sometimes it's useful to be able to change the shape of a photo - on our website PropertyMall, we like the <a href="http://www.propertymall.com/property/search?submit=Submit">thumbnails on our property search results</a> to be a nice uniform size.  Rather than stretch the images, we've chosen on that site to crop them down to the correct size, however this approach can sometimes have odd results.</p>

<p>I've just been looking at the <a href="http://liquidrescale.wikidot.com/">Liquid Rescale plugin for GIMP</a>, which attempts to let you rescale images to different aspect ratios without having to distort or crop out the important details.  The technology used is Seam Carving, which you can read about in this <a href="http://www.faculty.idc.ac.il/arik/imret.pdf">paper by Shai Avidan and Ariel Shamir</a>, or watch <a href="http://www.youtube.com/watch?v=6NcIJXTlugc">a video about it on Youtube</a>. </p>

<p>As an example, imagine I had a system that only accepted square images. Here is a picture I took a while back of some elephants:</p>

<p><a href="http://www.flickr.com/photos/ciaranmcnulty/430148669/" title="Elephants crossing by CiaranJMcNulty, on Flickr"><img src="http://farm1.static.flickr.com/166/430148669_f2364b452a_m.jpg" width="180" height="240" alt="Elephants crossing" /></a></p>

<p>Using traditional tools, I have two choices for making it square: I can stretch it or crop it.</p>

<div class="figure">
<a href="http://www.flickr.com/photos/ciaranmcnulty/3446656645/" title="Elephants pic, with comparison of stretched and cropped versions by CiaranJMcNulty, on Flickr"><img src="http://farm4.static.flickr.com/3338/3446656645_a671dd5a10.jpg" width="500" height="182" alt="Elephants pic, with comparison of stretched and cropped versions" /></a>
<p class="caption">The original, scaled and cropped versions</p>
</div>

<p>In the scaled version, the elephants look far too fat, while in the cropped version some of the interesting foreground and background are missing (ok, you may disagree that they're interesting but let's assume a more talented photographer took it).  What Liquid Rescale offers is a way of preserving the dimensions on the Elephants, which are quite easy to spot when they're wrong, while allowing the water, riverbank and trees to be scaled because that scaling will be much harder to spot.</p>

<p>Just running the image through the plugin gives a slightly better result than the scaled version, but the elephants still look stretched a bit.  The reason for this is presumably that the river isn't uniform enough for the algorithm to detect that it's scaleable.  The plugin allows you to specify certain areas of the image as inviolable, by scribbling over them with a mask - the whole process is quite simple and gives a very acceptable result:</p>

<div class="figure">
<a href="http://www.flickr.com/photos/ciaranmcnulty/3446656647/" title="Elephants pic, with example mask and Liquid Rescale by CiaranJMcNulty, on Flickr"><img src="http://farm4.static.flickr.com/3585/3446656647_50b494039f.jpg" width="500" height="201" alt="Elephants pic, with example mask and Liquid Rescale" /></a>
<p class="caption">The original, original with a mask, and the liquid rescaled version</p>
</div>

<p>As you can see, knowing that the elephants should be preserved, the algorithm has picked parts of the river and bank to stretch, and the final result is pretty good! I don't think I'd know at first glance that anything had been moved around.  Designers have been doing this sort of thing for years, of course, but normally with a bit more Photoshop effort, and some gruelling use of the clone tool.</p>

<p><a href="http://www.flickr.com/photos/ciaranmcnulty/3447514412/" title="Elephants crossing, Liquid Rescaled by CiaranJMcNulty, on Flickr"><img src="http://farm4.static.flickr.com/3311/3447514412_b48614b49b_m.jpg" width="240" height="240" alt="Elephants crossing, Liquid Rescaled" /></a></p>

<p>Of course, my main interest was in doing this automatically for website-building purposes, and I have to say the results without adding the hint mask were very disappointing.  However, it seems a useful tool for meddling with my photos in future, so my time wasn't completely wasted.  If I were to pursue this in future for our property thumbnails, I'd have to take a look 'under the hood' at the algorithm and see if there was a way of optimising it for 'building' colours and not for 'sky' colours, but that's not really something I'm likely to find the time for!</p>

<p>If you want to give it a go yourself, Linux people can <a href="http://liquidrescale.wikidot.com/en:download-page">get the GIMP plugin</a>, or Photoshop users can upgrade to CS4 where the same technology is used and called 'Content Aware Scaling'.</p>
    <hr>

        <nav class="article-pagination">
        <ul>
                        <li class="next">Next: <a href="/make-all-your-sites-work-in-ie8-with-one-fell-swoop" title="Make all your sites work in IE8 with one fell swoop">Make all your sites work in IE8 with one fell swoop</a></li>
                                    <li class="previous">Previous: <a  href="/rev-canonical-should-be-handled-with-care" title="Rev-canonical should be handled with care">Rev-canonical should be handled with care</a></li>
                    </ul>
    </nav>
    
</section>

</body>

</html>
